# Railway Fullstack Deployment

services:
  # Backend Service (Streamlit)
  - type: web
    name: sophi-backend
    env: docker
    dockerfilePath: ./Dockerfile.render
    plan: free
    healthCheckPath: /_stcore/health
    envVars:
      - key: PORT
        value: 8501
      - key: PYTHON_VERSION
        value: 3.11
      # API Keys (set these in Railway dashboard)
      - key: OPENAI_API_KEY
        sync: false
      - key: GEMINI_API_KEY
        sync: false
      - key: ELEVENLABS_API_KEY
        sync: false
      - key: STABILITY_API_KEY
        sync: false
      - key: HUGGINGFACE_API_KEY
        sync: false
      - key: REPLICATE_API_KEY
        sync: false
      - key: RUNWAY_API_KEY
        sync: false

  # Frontend Service (Next.js)
  - type: web
    name: sophi-frontend
    env: static
    buildCommand: cd v0-design && npm ci && npm run build
    staticPublishPath: v0-design/out
    plan: free
    envVars:
      - key: NODE_ENV
        value: production
      - key: NEXT_PUBLIC_API_URL
        value: ${sophi-backend.url}
